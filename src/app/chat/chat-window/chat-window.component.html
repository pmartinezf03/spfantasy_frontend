<div class="flex flex-col h-full bg-gradient-to-b from-gray-800 to-gray-900 text-white">

  <!-- 🧾 Zona de mensajes -->
  <div #scrollContainer class="flex-1 overflow-y-auto p-4 space-y-3">
    <div *ngFor="let mensaje of mensajesOrdenados"
         [ngClass]="[
           'max-w-[75%] px-4 py-2 rounded-xl shadow-lg text-sm whitespace-pre-wrap relative transition-all duration-200',
           mensaje.remitenteId === usuarioActual.id || mensaje.remitente?.id === usuarioActual.id
             ? 'bg-green-500 text-white self-end rounded-br-none'
             : 'bg-slate-200 text-gray-800 self-start rounded-bl-none',
           mensaje.grupoId ? getColorClase(mensaje.remitenteId!) : ''
         ]">

      <!-- 👤 Nombre del remitente -->
      <div *ngIf="mensaje.remitenteId !== usuarioActual.id || mensaje.grupoId"
           class="text-xs font-bold text-fantasyGold mb-1">
        {{ mensaje.remitenteNombre }}
        <span *ngIf="mensaje.remitenteAlias" class="ml-1 text-gray-500 italic">
          &#64;{{ mensaje.remitenteAlias }}
        </span>
      </div>

      <div class="text-sm">{{ mensaje.contenido }}</div>

      <div class="text-[0.65rem] text-right mt-1 text-gray-400">
        {{ mensaje.timestamp | date: 'HH:mm' }}
      </div>
    </div>
  </div>

  <!-- 📝 Input de mensaje -->
  <div class="flex items-center px-4 py-3 bg-gray-100 border-t border-gray-300">
    <input
      type="text"
      [(ngModel)]="nuevoMensaje"
      placeholder="Escribe tu mensaje..."
      (keydown.enter)="enviar()"
      class="flex-1 px-4 py-2 rounded-full bg-white text-gray-800 placeholder-gray-400 outline-none focus:ring-2 focus:ring-fantasyBlue shadow-inner"
    />
    <button
      (click)="enviar()"
      class="ml-3 bg-fantasyBlue hover:bg-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-md"
    >
      <i class="pi pi-send text-base"></i>
    </button>
  </div>
</div>
