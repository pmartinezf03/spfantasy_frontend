<nav
  class="w-full sticky top-0 z-50 bg-gradient-to-r from-fantasyDark via-black to-fantasyDark shadow-md px-4 py-3 flex flex-wrap items-center justify-between gap-y-3"
>
  <!-- Logo -->
  <div
    id="nav-logo"
    class="flex items-center gap-3 logo-navbar"
    (click)="router.navigate(['/'])"
  >
    <img src="https://i.imgur.com/YNo7zAj.png" alt="Logo" class="h-20 w-auto" />
    <span class="text-xl text-white font-futuristic">SP Fantasy</span>
  </div>

  <!-- BotÃ³n hamburguesa -->
  <button
    class="md:hidden text-white text-3xl"
    (click)="menuAbierto = !menuAbierto"
  >
    â˜°
  </button>

  <!-- MenÃº principal (escritorio) -->
  <ul class="navbar-links">
    <ng-container *ngIf="isUserLoggedIn; else menuPublico">
      <!-- MenÃº completo si estÃ¡ logueado -->
      <li id="nav-inicio" class="menu-item-inicio">
        <a
          routerLink="/"
          routerLinkActive="text-fantasyGold"
          [routerLinkActiveOptions]="{ exact: true }"
          >ğŸ  Inicio</a
        >
      </li>
      <li id="nav-estadisticas">
        <a routerLink="/estadisticas-liga" routerLinkActive="text-fantasyGold"
          >ğŸ“Š EstadÃ­sticas</a
        >
      </li>
      <li id="nav-noticias">
        <a routerLink="/noticias" routerLinkActive="text-fantasyGold"
          >ğŸ“° Noticias</a
        >
      </li>
      <li id="nav-mercado">
        <a routerLink="/mercado" routerLinkActive="text-fantasyGold"
          >ğŸ›’ Mercado</a
        >
      </li>
      <li id="nav-plantilla" class="menu-item-plantilla">
        <a routerLink="/plantilla" routerLinkActive="text-fantasyGold"
          >ğŸ€ Mi Plantilla</a
        >
      </li>
      <li id="nav-ligas">
        <a routerLink="/ligas" routerLinkActive="text-fantasyGold">ğŸ† Ligas</a>
      </li>
      <li id="nav-chat">
        <a routerLink="/chat" routerLinkActive="text-fantasyGold">ğŸ’¬ Chat</a>
      </li>
      <li id="nav-ofertas" class="menu-item-ofertas">
        <a routerLink="/ofertas" routerLinkActive="text-fantasyGold"
          >ğŸ“© Ofertas <span *ngIf="tieneOfertasNuevas">ğŸ”´</span></a
        >
      </li>
      <li id="nav-comparador">
        <a routerLink="/comparador" routerLinkActive="text-fantasyGold"
          >ğŸ“ˆ Comparador</a
        >
      </li>
      <li id="nav-canjear">
        <a routerLink="/canjear-codigo" routerLinkActive="text-fantasyGold"
          >ğŸ Canjear
        </a>
      </li>
    </ng-container>
  </ul>

  <ng-template #menuPublico>
    <div class="flex gap-4 items-center ml-auto">
      <!-- ml-auto empuja a la derecha -->
      <button
        (click)="reiniciarSesion()"
        class="text-white font-bold px-6 py-2 bg-fantasyBlue hover:bg-fantasyGold rounded-md shadow transition-all hover:scale-105 transform"
      >
        Iniciar SesiÃ³n
      </button>
      <button
        (click)="router.navigate(['/auth/register'])"
        class="text-white font-bold px-6 py-2 bg-fantasyGold hover:bg-fantasyBlue rounded-md shadow transition-all hover:scale-105 transform"
      >
        Registrarse
      </button>
    </div>
  </ng-template>

  <!-- MenÃº mÃ³vil -->
  <div *ngIf="menuAbierto" class="mobile-menu md:hidden">
    <ng-container *ngIf="isUserLoggedIn; else menuMovilPublico">
      <a class="menu-item-inicio" routerLink="/" (click)="menuAbierto = false"
        >ğŸ  Inicio</a
      >
      <a routerLink="/estadisticas-liga" (click)="menuAbierto = false"
        >ğŸ“Š EstadÃ­sticas</a
      >
      <a routerLink="/noticias" (click)="menuAbierto = false">ğŸ“° Noticias</a>
      <a routerLink="/mercado" (click)="menuAbierto = false">ğŸ›’ Mercado</a>
      <a
        class="menu-item-plantilla"
        routerLink="/plantilla"
        (click)="menuAbierto = false"
        >ğŸ€ Mi Plantilla</a
      >
      <a routerLink="/ligas" (click)="menuAbierto = false">ğŸ† Ligas</a>
      <a routerLink="/chat" (click)="menuAbierto = false">ğŸ’¬ Chat</a>
      <a
        class="menu-item-ofertas"
        routerLink="/ofertas"
        (click)="menuAbierto = false"
      >
        {{ tieneOfertasNuevas ? "ğŸ“© Ofertas ğŸ”´" : "ğŸ“© Ofertas" }}
      </a>
      <a routerLink="/comparador" (click)="menuAbierto = false"
        >ğŸ“ˆ Comparador</a
      >
      <a routerLink="/canjear-codigo" (click)="menuAbierto = false"
        >ğŸ Canjear CÃ³digo</a
      >
      <a routerLink="/perfil" (click)="menuAbierto = false">ğŸ‘¤ Mi Perfil</a>

      <button
        (click)="logout(); menuAbierto = false"
        class="bg-red-600 hover:bg-red-400 text-white font-bold py-2 px-4 rounded-md shadow mt-2"
      >
        Cerrar SesiÃ³n
      </button>
    </ng-container>

    <ng-template #menuMovilPublico>
      <div class="flex flex-col items-center gap-2 w-full">
        <button
          (click)="reiniciarSesion(); menuAbierto = false"
          class="btn-login"
        >
          Iniciar SesiÃ³n
        </button>
        <button
          (click)="router.navigate(['/auth/register']); menuAbierto = false"
          class="btn-register"
        >
          Registrarse
        </button>
      </div>
    </ng-template>
  </div>

  <!-- Usuario o Login (escritorio) -->
  <div
    *ngIf="isUserLoggedIn && usuarioLogueado"
    class="hidden md:flex flex-col text-right text-white text-sm font-semibold items-end"
  >
    <div
      id="nav-avatar"
      class="flex items-center gap-2 cursor-pointer hover:underline"
      (click)="router.navigate(['/perfil'])"
    >
      <div
        class="avatar-navbar"
        [ngStyle]="{
          'background-image':
            'url(' + (avatarBase64 || 'assets/default-avatar.png') + ')'
        }"
      ></div>
      <span>{{ usuarioLogueado }}</span>
    </div>
    <div class="text-fantasyGold">
      ğŸ’° {{ usuarioDinero | currency : "EUR" }}
    </div>
    <div class="text-xs text-red-400">
      ({{ usuarioDineroPendiente | currency : "EUR" }} pendientes)
    </div>
    <div
      *ngIf="esVip()"
      class="vip-badge animate__animated animate__pulse animate__infinite"
    >
      ğŸŒŸ VIP
    </div>
    <button
      (click)="logout()"
      class="mt-1 text-xs text-fantasyRed underline hover:text-red-300 transition-all"
    >
      Cerrar sesiÃ³n
    </button>
  </div>
</nav>
